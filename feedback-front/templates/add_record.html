{% extends "layout.html" %}
{% block body %}
  {% if error %}
    <div class="uk-alert uk-alert-danger">
      {% if errno %}
        Message : {{ error }} 
        <br> 
        Status : {{errno}}
      {% else %}
        {{ error }}
      {% endif %} 
    </div>
  {% endif %}
  {% if success %}<div class="uk-alert">{{ success }}</div>{% endif %}

  <form class="uk-form" action="{{ url_for('post_record', dataset=dataset, mydata=mydata) }}" method="post" id="add-record-form">
      <fieldset>
          <legend>Add Record</legend>
          <div class="uk-form-row">
            <input type="text" name="ID" placeholder="ID" autofocus enabled>
          </div>
          <div class="uk-form-row">
            <input type="text" name="label" placeholder="Label (Optional)">
          </div>
          <div class="uk-form-row" id="content">
          </div>
          <div class="uk-form-row">
            <button id="content" class="uk-button" type="button" onclick="addContentDiv()" onclick="processBeforePost()">Add Content</button>
          </div>
          <br>
          <div class="uk-form-row">
            <button class="uk-button" value="Submit" onclick="processBeforePost()">Submit</button>
          </div>
      </fieldset>
  
  <!-- Not able to add Key:Value values to the database -->
  <script>
    function addContentDiv() {
      var newdiv = document.createElement('div');
      newdiv.innerHTML = "<div class='uk-form-row' id='content'><input value='' type='text' id='content-key' placeholder='Content-Key' value='Content-'>"
      document.getElementById("content").appendChild(newdiv);

      var newdiv = document.createElement('div');
      newdiv.innerHTML = "<input type='text' placeholder='Content-Value' id='content-value' value=''></form><br>"
      document.getElementById("content").appendChild(newdiv);
    }

    $('#add-record-form').submit(function() {
    // get all the inputs into an array.
      var $inputs = $('#add-record-form :input');

      // not sure if you wanted this, but I thought I'd add it.
      // get an associative array of just the values.
      var values = {};
      $inputs.each(function() {
          values[this.name] = $(this).val();
        });
      alert(values);
    });

    function processBeforePost(){
      var key = $('#content-key').val();
      var value = $('#content-value').val();

      mydata = JSON.stringify($('#content').serialize());
      /*alert(mydata);
      alert(key);
      alert(value); */
    }
  </script>
</form>
{% endblock %}
