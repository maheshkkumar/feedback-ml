{% extends "layout.html" %}
{% block body %}

  <div class="uk-grid" data-uk-grid-margin>
      <div class="uk-width-1-1">
          <h2>Records</h2>
          <a href="{{ url_for('add_record_page', dataset=dataset) }}"><button class="uk-button uk-button-primary">Add Record</button></a>
          {% if error %}<div class="uk-alert uk-alert-danger">{{ error }} </div>{% endif %}
      </div>
      <div class="uk-width-1-1">
          <h3>Showing records {{records|length}} of {{totalRecords}}</h3>
      </div>
  </div>

  <table class="uk-table uk-table-hover uk-table-striped">
    <thead>
        <tr>
            <th>ID</th>
            <th>Label</th>
            <th>Edit/View</th>
            <th>Delete</th>
        </tr>
    </thead>
    <tbody>
    {% for record in records %}
        <tr>
            <td>{{record.id}}</td>

            {% if record.label %}
              <td class="uk-text-bold">{{record.label}}</id>
            {% else %}
              <td id = "label-name-td" class="uk-text-muted"><button class="uk-button uk-button-success" data-uk-modal="{target:'#addLabel'}" type="button">Add Label</button></td>
            {% endif %}

            <td><button class="uk-button uk-button-primary" data-uk-modal="{target:'#editRecord{{record.id}}'}" type="button">Edit</button></td>
            <td><button class="uk-button uk-button-danger" data-uk-modal="{target:'#deleteRecord{{record.id}}'}" type="button">Delete</button></td>
        </tr>
    {% endfor %}
    </div>
    </tbody>
  </table>

  <!-- divison of modal to edit the label name -->
  {% for record in records %}
    <form class="uk-form" id="add-label-value"  onclick="client.addLabelValue('add-label-value', '{{ dataset }}', '{{ record.id }}'); return false;">
      <div id="addLabel" class="uk-modal">
        <div class="uk-modal-dialog">
            <a class="uk-modal-close uk-close"></a>
            <form class="uk-form">
              <legend>Enter the Label Name</legend>
              <input id="label-name" type="text" name="newLabelName" placeholder="label name" autofocus>
              <button id="add-label-btn" class="uk-button uk-button-primary">Submit</button>
            </form>
        </div>
      </div>
    </form>
  {% endfor %}
  

  <!-- divison of modal to delete a record -->
  {% for record in records %}
    <div id="deleteRecord{{record.id}}" class="uk-modal">
      <div class="uk-modal-dialog">
          <a class="uk-modal-close uk-close"></a>
          <form class="uk-form">
            <legend>Are you sure to delete {{record.id}}?</legend>
            <button class="uk-button uk-button-success" onclick="client.removeRecord('{{record.id}}', '{{record.label}}', 'dataset', 'skip', 'limit')">Yes</button>
            <button class="uk-button uk-button-danger">No</button>
          </form>
      </div>
    </div>
  {% endfor %}


  {% for record in records%}  
    <div id="editRecord{{record.id}}" class="uk-modal">
      <div class="uk-modal-dialog">
          <a class="uk-modal-close uk-close"></a>
          <form class="uk-form uk-form-stacked">
            <legend>Edit Record {{record.id}}</legend>
            <div class="uk-form-row">
              <label class="uk-form-label" for="ID">Record ID</label>
              <input id="ID" type="text" placeholder="ID" value="{{record.id}}" autofocus disabled>
            </div>
            <div class="uk-form-row">
              <label class="uk-form-label" for="label">Label</label>
              <input id="label" type="text" placeholder="Label" value="{{record.label}}" autofocus disabled>
            </div>
            {% if record.content %}
                {% for key, value in record.content.iteritems() %}
                  <div class="uk-form-row">
                    <label class="uk-form-label" for="content-{{key}}">Content - {{key}}</label>
                    <input type='text' name='content-{{key}}' placeholder='Content - {{key}}' value={{value}} />
                  </div>
                {% endfor %}
            {% endif %}
            <div class="uk-form-row">
              <button id="add-label-btn" class="uk-button uk-button-primary" onclick="console.log('moooo')">Submit</button>
            </div>
          </form>
      </div>
    </div>
  {% endfor %}
  {% if start %}
    {% set begin = start %}
  {% else %}
    {% set begin = 0 %}
  {% endif %}
    <ul class="uk-pagination" data-uk-pagination="{items:{{ totalRecords }}, itemsOnPage:{{ limit }}}">
      {% if begin == 0 %}
        <li><button class="uk-button" type="button" disabled>Previous</button></li>
      {% else %}
        <li><button class="uk-button" type="button">Previous</button></li>
      {% endif %}
      {% if totalRecords > 10 %}
        {% for i in range((totalRecords/limit)|int + 1) %}
          <li class="uk-active"><button class="uk-button uk-button-primary" type="button">{{ i+1 }}</button></li>
        {% endfor %}
      {% else %}
          <li class="uk-active"><button class="uk-button uk-button-primary" type="button">{{ begin+1 }}</button></li>
      {% endif %}
      {% if begin == totalRecords/limit %}
        <li><button class="uk-button" type="button" disabled>Next</button></li>
      {% else %}
        <li><a href="{{ url_for('nextRecords', dataset=dataset,  start=begin, limit=limit) }}"><button class="uk-button" type="button">Next</button></a></li>
      {% endif %}
    </ul>
  
  

  <!--
  <ul class="uk-pagination" data-uk-pagination="{items:100, itemsOnPage:10, currentPage:2 }">
    <li><a href="">Previous</a></li>
    <li class="uk-active"><span>1</span></li>
    <li class="uk-disabled"><span>2</span></li>
    <li><a href="">Next</a></li>
  </ul>

  <script>
    $('[data-uk-pagination]').on('select.uk.pagination', function(e, pageIndex){
      alert('You have selected page: ' + (pageIndex+1));
    });
  </script>
-->

{% endblock %}
